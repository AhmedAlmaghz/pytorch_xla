


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. من مجموعة البيانات المدخلة &mdash; PyTorch/XLA master documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','');</script>
    <!-- End Google Tag Manager -->
  

  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>

          <li class="main-menu-item">
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Learn
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/get-started">
                  <span class=dropdown-title>Get Started</span>
                  <p>Run PyTorch locally or get started quickly with one of the supported cloud platforms</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials">
                  <span class="dropdown-title">Tutorials</span>
                  <p>Whats new in PyTorch tutorials</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/basics/intro.html">
                  <span class="dropdown-title">Learn the Basics</span>
                  <p>Familiarize yourself with PyTorch concepts and modules</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/recipes/recipes_index.html">
                  <span class="dropdown-title">PyTorch Recipes</span>
                  <p>Bite-size, ready-to-deploy PyTorch code examples</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/introyt.html">
                  <span class="dropdown-title">Intro to PyTorch - YouTube Series</span>
                  <p>Master PyTorch basics with our engaging YouTube tutorial series</p>
                </a>
              </div>
            </div>
          </li>

          <li>
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Ecosystem
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/ecosystem">
                  <span class="dropdown-title">Tools</span>
                  <p>Learn about the tools and frameworks in the PyTorch Ecosystem</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
                  <span class=dropdown-title>Community</span>
                  <p>Join the PyTorch developer community to contribute, learn, and get your questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
                  <span class=dropdown-title>Forums</span>
                  <p>A place to discuss PyTorch code, issues, install, research</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class=dropdown-title>Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/ecosystem/contributor-awards-2023">
                  <span class="dropdown-title">Contributor Awards - 2023</span>
                  <p>Award winners announced at this year's PyTorch Conference</p>
                </a>
              </div>
            </div>
          </li>

          <li>
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Edge
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/edge">
                  <span class="dropdown-title">About PyTorch Edge</span>
                  <p>Build innovative and privacy-aware AI experiences for edge devices</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/executorch-overview">
                  <span class="dropdown-title">ExecuTorch</span>
                  <p>End-to-end solution for enabling on-device inference capabilities across mobile and edge devices</p>
                </a>
              </div>
            </div>  
          </li>

          <li class="main-menu-item">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Docs
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span>
                  <p>Explore the documentation for comprehensive guidance on how to use PyTorch</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/pytorch-domains">
                  <span class="dropdown-title">PyTorch Domains</span>
                  <p>Read the PyTorch Domains documentation to learn more about domain-specific libraries</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Blogs & News 
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/blog/">
                  <span class="dropdown-title">PyTorch Blog</span>
                  <p>Catch up on the latest technical news and happenings</p>
                </a>
                 <a class="nav-dropdown-item" href="https://pytorch.org/community-blog">
                  <span class="dropdown-title">Community Blog</span>
                  <p>Stories from the PyTorch ecosystem</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/videos">
                  <span class="dropdown-title">Videos</span>
                  <p>Learn about the latest PyTorch tutorials, new, and more </p>
                <a class="nav-dropdown-item" href="https://pytorch.org/community-stories">
                  <span class="dropdown-title">Community Stories</span>
                  <p>Learn how our community solves real, everyday machine learning problems with PyTorch</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/events">
                  <span class="dropdown-title">Events</span>
                  <p>Find events, webinars, and podcasts</p>
                </a>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                About
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/foundation">
                  <span class="dropdown-title">PyTorch Foundation</span>
                  <p>Learn more about the PyTorch Foundation</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/governing-board">
                  <span class="dropdown-title">Governing Board</span>
                  <p></p>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div class="no-dropdown">
              <a href="https://pytorch.org/join" data-cta="join">
                Become a Member
              </a>
            </div>
          </li>
          <li>
           <div class="main-menu-item">
             <a href="https://github.com/pytorch/pytorch" class="github-icon">
             </a>
           </div>
          </li>
          <!--- TODO: This block adds the search icon to the nav bar. We will enable it later. 
          <li>
            <div class="main-menu-item">
             <a href="https://github.com/pytorch/pytorch" class="search-icon">
             </a>
            </div>
          </li>
          --->
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  master (2.4.0 )
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">وثائق PyTorch/XLA</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">الوثائق</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../debug.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eager_mode.html">وضع Eager + واجهة برمجة تطبيقات Compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eager_mode.html#id1">الخلفية</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eager_mode.html#id2">الاستخدام الأساسي</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eager_mode.html#id5">المعيار المرجعي</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu.html">كيفية التشغيل باستخدام PyTorch/XLA:GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multi_process_distributed.html">كيفية تنفيذ DistributedDataParallel (DDP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quantized_ops.html">عمليات كمية لأجهزة XLA (ميزة تجريبية)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html">وقت تشغيل PJRT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html#pytorch-xla-r2-1">الميزات الجديدة في PyTorch/XLA r2.1:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html#pytorch-xla-r2-0">الميزات الجديدة في PyTorch/XLA r2.0:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html#id2">خلاصة القول</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html#id4">الفوائد</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html#id5">البدء السريع</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html#id11">الاختلافات عن XRT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html#pjrt-torch-distributed">PJRT و torch.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html#id14">الأداء</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runtime.html#id15">وقت تشغيل TPU الجديد</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spmd.html">PyTorch/XLA SPMD الدليل الإرشادي للمستخدم</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spmd.html#fully-sharded-data-parallel-fsdp-spmd">Fully Sharded Data Parallel(FSDP) عبر SPMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spmd.html#id17">PyTorch/XLA SPMD المواضيع المتقدمة</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spmd.html#id26">الحفظ الموزع للإشارات المرجعية</a></li>
<li class="toctree-l1"><a class="reference internal" href="../torch_compile.html">تكامل TorchDynamo (torch.compile) في PyTorch XLA</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>1. من مجموعة البيانات المدخلة</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/notes/source_of_recompilation.md.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          <!-- Google Tag Manager (noscript) -->
          <noscript><iframe src="https://www.googletagmanager.com/ns.html?id="
          height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
          <!-- End Google Tag Manager (noscript) -->
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <p>مصدر إعادة التجميع في torch_xla</p>
<p>دعونا نبدأ أولا ببعض الحقائق/القيود:</p>
<ol class="arabic simple">
<li><p>عمليات تجميع الرسوم البيانية في XLA مكلفة للغاية.</p></li>
<li><p>XLA يتعامل مع الشكل الثابت فقط. وبعبارة أخرى، حتى لنفس رسم IR، XLA يعيد التجميع عند تغيير شكل الإدخال.</p></li>
<li><p>تؤثر عمليات إعادة التجميع سلبًا على أداء torch_xla بشكل كبير عندما تحدث، ومن الصعب فهمها وإصلاحها من وجهة نظر المستخدم العادي لـ Python.</p></li>
</ol>
<p>غالبًا ما نقول عندما تحدث عملية إعادة التجميع، إننا نحتاج فقط إلى دعم الشكل الديناميكي، ثم نطمئن إلى أنه عندما يتم دعم الشكل الديناميكي في المستقبل، ستختفي جميع عمليات إعادة التجميع بشكل سحري. لكن هذا غير صحيح، حيث أن XLA لديه بالفعل تغطية جيدة جدًا للأشكال الديناميكية المحدودة، ولكننا ما زلنا نرى عمليات إعادة التجميع وهي متوقعة.</p>
<p>تهدف هذه الوثيقة إلى تقديم شرح مفصل لبعض المصادر الشائعة لإعادة التجميع، وما نحتاج إلى فعله للتخلص منها. ستركز بشكل أساسي على شرح المشكلة للمبتدئين دون أي سياق. لتسهيل الفهم، قد تعتمد “الحلول” المقترحة هنا على افتراضات غير عملية.</p>
<div class="section" id="id1">
<h1>1. من مجموعة البيانات المدخلة<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h1>
<p>نعم، من الشائع جدًا أن تحتوي مجموعة البيانات المدخلة على أمثلة بأشكال مختلفة، مثل الجمل ذات الأطوال المختلفة أو الصور بأحجام مختلفة. بدون التوحيد القياسي، سيؤدي ذلك إلى إعادة تجميع لكل شكل إدخال جديد.</p>
<p>عادة ما يقوم مستخدمو وضع الرسم البياني TensorFlow بإجراء التعبئة/التقسيم إلى دلو (tf.pad) لتوحيد أشكال الإدخال إلى دلو واحد أو عدد قليل من الدلاء. ولكن هذا يتعارض مع نمط مستخدمي واجهة PyTorch الأمامية المتحمسين (والذي يستهدف واجهة المستخدم الأمامية للتوتر الكسول أيضًا) نظرًا لأن أشكال الإدخال المختلفة لا تهم الواجهة الخلفية لـ CPU/CUDA المتحمسة.</p>
<p>حل بديل مقترح: حسنًا، دعنا نقول إننا يمكننا حل هذه المشكلة عن طريق تعليم مستخدمينا إجراء التعبئة/التقسيم إلى دلو (من الصعب القيام بذلك عمليًا :P). ما التالي؟</p>
</div>
<div class="section" id="id2">
<h1>2. من إخراج المشغل<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h1>
<p>هناك بعض المشغلات التي تكون ديناميكية من الناحية الدلالية وتنتج أشكال إخراج ديناميكية: على سبيل المثال، يعيد torch.nonzero المؤشرات إلى العناصر غير الصفرية في موتر الإدخال الخاص به. لذلك، حتى إذا كانت موترات الإدخال لهذا المشغل دائمًا بنفس الشكل، فقد ينتج أشكال إخراج مختلفة ويتسبب في عمليات إعادة تجميع.</p>
<p>2.1 يمكن أن يصلح الشكل الديناميكي المحدود الحالة التي تستخدم فيها الموتر ذو الشكل الديناميكي كموتر، دون الاستعلام عن أبعاده الفعلية.</p>
<p>حل بديل مقترح: دعنا نقول الآن أن XLA يدعم الشكل الديناميكي المحدود لجميع المشغلين، فهل هذا جيد بما فيه الكفاية؟</p>
<ul class="simple">
<li><p>يعني الشكل الديناميكي المحدود أنه يمكننا تعبئة الموتر إلى الحد الأقصى النظري، مما يؤدي إلى زيادة استخدام الذاكرة مقابل تقليل إعادة التجميع/زيادة السرعة.</p></li>
</ul>
<p>حسنًا، إلى حد ما. دعنا نرى المثال التالي:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;xla&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">torch_xla</span><span class="o">.</span><span class="n">_XLAC</span><span class="o">.</span><span class="n">_get_xla_tensors_text</span><span class="p">([</span><span class="n">d</span><span class="p">]))</span>
</pre></div>
</div>
<p>في المثال أعلاه، سيكون لكل عقدة أسفل “b” في الرسم البياني (بمعنى “c” و”d” وكل ما يعتمد عليهما) شكل ديناميكي، ومن الواضح أن “b” له شكل ديناميكي في البعد 0 كما هو موضح أدناه:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="mi">9</span> <span class="o">=</span> <span class="p">(</span><span class="n">s64</span><span class="p">[</span><span class="o">&lt;=</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span> <span class="n">s64</span><span class="p">[])</span> <span class="n">aten</span><span class="p">::</span><span class="n">nonzero</span><span class="p">(</span><span class="o">%</span><span class="mi">8</span><span class="p">),</span> <span class="n">num_outputs</span><span class="o">=</span><span class="mi">2</span> <span class="c1"># b</span>
<span class="o">%</span><span class="mi">10</span> <span class="o">=</span> <span class="n">s64</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">}</span> <span class="n">aten</span><span class="p">::</span><span class="n">mul</span><span class="p">(</span><span class="o">%</span><span class="mf">9.0</span><span class="p">,</span> <span class="o">%</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># c</span>
<span class="o">%</span><span class="mi">11</span> <span class="o">=</span> <span class="n">s64</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">}</span> <span class="n">aten</span><span class="p">::</span><span class="n">add</span><span class="p">(</span><span class="o">%</span><span class="mi">10</span><span class="p">,</span> <span class="o">%</span><span class="mi">2</span><span class="p">),</span> <span class="n">ROOT</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># d</span>
</pre></div>
</div>
<p>على الرغم من أنه لا يتم عرضه مباشرة في الرسم البياني، فإن “c” و”d” لهما أيضًا شكل ديناميكي (بعبارة أخرى، [5، 1] هو الشكل المبطن فقط وهو مقنع).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">torch_xla</span><span class="o">.</span><span class="n">_XLAC</span><span class="o">.</span><span class="n">_get_xla_tensor_dimension_size</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1"># prints 4 instead of 5</span>
</pre></div>
</div>
<p>يمكنك أن ترى أنه في هذه الحالة، طالما أن موتر الإدخال “a” له الشكل [5]، فإننا نقوم بتجميع الرسم البياني مرة واحدة فقط. ساعد دعم الشكل الديناميكي المحدود!</p>
<p>2.2 ماذا لو تم الاستعلام عن البعد الفعلي على موتر ذي شكل ديناميكي؟</p>
<p>يتم استخدام هذا بالفعل بشكل شائع نظرًا لأن حسابات PyTorch لا تتم جميعها على شكل موترات.</p>
<p>على سبيل المثال، تعيد tensor.size() في PyTorch مجموعة من الأعداد الصحيحة بدلاً من موتر من dtype=int. عندما يكون “الموتر” موترًا ذا شكل ديناميكي، فإن هذا المشغل يجبر XLA فعليًا على قطع الرسم البياني وتقييمه حتى نتمكن من إعادة القيمة الصحيحة (وإلا فإنه سيعيد الشكل المبطن فقط وهو خطأ).</p>
<p>ما زاد الأمر سوءًا هو أن العديد من PyTorch يأخذ إدخالات قياسية أيضًا. بعد أن تقوم بـ s = tensor.size(0) وتستخدم “s” في مشغلين آخرين، فإنه يصبح مصدرًا ديناميكيًا أيضًا. في هذه الحالة، ربما نعرف كيفية تعبئتها وحدودها العليا، ولكن لا يمكننا القيام بذلك لأنها ليست موترًا حتى!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;xla&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># يحدث التقييم! ملاحظة: نستخدم size() للتبسيط، واجهة برمجة التطبيقات الفعلية هي _get_xla_tensor_dimension_size.</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;xla&#39;</span><span class="p">)</span> <span class="c1"># يمكن أن يكون c بأي شكل بين [0، 5] مما يتسبب في المزيد من عمليات إعادة التجميع!</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>لذلك، من الصعب حل هذه المشكلة دون مساعدة واجهة PyTorch الأمامية. ماذا نحتاج؟</p>
<p>باختصار، نحتاج إلى عالم موتر!</p>
<p>على سبيل المثال،</p>
<ul class="simple">
<li><p>يجب أن تعيد tensor.size() موترًا حتى يمكن أن يكون موترًا ذا شكل ديناميكي ويظل في الرسم البياني دون تقييم مبكر.</p></li>
<li><p>موتر الملحق، على سبيل المثال لموتر ثنائي الأبعاد، tensor[0][0] يعيد الآن قيمة ولكن هذا يجب أن يعيد موترًا أيضًا.</p></li>
<li><p>ضمنيًا، يعني ذلك أن جميع المشغلين الذين يقبلون int/float/double كإدخال يحتاجون إلى زيادة الحمل الزائد للموتر أيضًا. هذا طلب كبير لأنه يمكن أن يزيد بسهولة مجموعة المشغلين لدينا.</p></li>
<li><p>من الأسهل إذا كان من الممكن جعل تحويل القيمة القياسية إلى موتر رخيصًا جدًا حتى نتمكن من الاهتمام فقط بزيادة الحمل الزائد للموتر.</p></li>
<li><p>في الممارسة العملية، لا تأخذ جميع المشغلين قياسات من الحسابات السابقة، لذا فقد كنا نضيف متغيرات الموتر عن طريق طلبات مخصصة.</p></li>
<li><p>هذا أيضًا طلب شائع من نهج التتبع الأساسي أعتقد.</p></li>
</ul>
<p>حسنًا، الآن افترض أن كل عملية في PyTorch لديها إصدار Tensor نحتاجه، هل انتهينا؟</p>
</div>
<div class="section" id="id3">
<h1>3. من تدفق التحكم<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h1>
<p>كلا! لقد قمنا بالفعل بحل المشكلة دون تدفق تحكم يعتمد على البيانات…</p>
<p>انظر المثال أدناه:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<span class="n">bla</span>
<span class="k">else</span><span class="p">:</span>
<span class="n">blabla</span>
</pre></div>
</div>
<p>حتى إذا كان x[0][0] موترًا، فيجب علينا تنفيذ/تجسيد قيمته حتى يتمكن مفسر Python من الاستمرار. واختيار فرع مختلف في تدفقات التحكم المتعددة مجتمعة يعني أن لدينا الكثير من الرسوم البيانية لتجميعها أيضًا!</p>
<p>في الوقت الحالي، ليس لدينا طريقة لإصلاح ذلك. لإصلاحه، نحتاج إلى تقليل تدفق التحكم من Python إلى الرسم البياني! دون الكثير من التفكير في التنفيذ، يمكننا القيام بذلك بطريقتين:</p>
<ul class="simple">
<li><p>اطلب من المستخدمين استخدام مشغل تدفق تحكم بشكل صريح بدلاً من Python if/else/while/for. هذا مدعوم حاليًا كـ <a class="reference external" href="https://github.com/pytorch/xla/blob/master/torch_xla/core/xla_builder.py#L563-L574">واجهة برمجة تطبيقات مخصصة في torch_xla</a> ولكنه غير مُعتمد على نطاق واسع في رمز المستخدم. (اعتاد مستخدمو Python على if/else/for ومن الصعب تحويلهم إلى واجهة برمجة تطبيقات أكثر قبحًا ما لم يكن هناك فوز كبير في الأداء).</p></li>
<li><p>قم بتفسير رمز مصدر Python للحصول على بيان تدفق التحكم تلقائيًا. هذا مثل Torchscript وبطريقة ما قم بدمج الرسم البياني لـ Torchscripted في الرسم البياني الذي يتم تتبعه بإهمال (بما في ذلك معلومات الشكل وما إلى ذلك). لم أفكر في خطوات التنفيذ بالفعل :P</p></li>
</ul>
<p>ولكن يتطلب أي حل أعلاه قدرًا غير قليل من الجهد، إما على جانب المستخدم أو على جانب الإطار. ولهذا نتحمل حاليًا ضربة التقييم المبكر وعمليات التجميع المتعددة كحل قصير الأجل بالنطاق الترددي الذي نمتلكه.</p>
<p>حسنًا، لذا افترض الآن أن لدينا أيضًا تدفق تحكم مخفض في الرسم البياني تلقائيًا، هل نحن جاهزون؟</p>
<p>نعم! الآن لديك كل حساباتك ممثلة في رسم بياني لعمليات موتر، بما في ذلك تدفق التحكم بحيث يمكن للمترجمين الآن استهلاكها والقيام بالحيل الذكية الخاصة بهم! ولكن بصراحة، في هذه المرحلة، لم يعد برنامجك يشبه PyTorch.</p>
<p>الخلاصة:</p>
<p>هناك في الواقع مصادر متعددة لإعادة التجميع ولا يمكن أن يحل الشكل الديناميكي المحدود كل ذلك. الحلول البديلة المقترحة في هذه الوثيقة غير عملية في بعض الأحيان، وقد تكون هناك طرق أفضل لإصلاح كل مصدر بشكل صحيح لا أعرفه على الإطلاق. ولكن آمل أنه مع استمرارنا في شق طريقنا إلى مكدس التوتر الكسول المثالي في هذه الوثيقة، أصبح من الأسهل الآن فهم العقبات المتبقية أمامنا.</p>
<p>التذييل:</p>
<ol class="arabic simple">
<li><p>يستخدم NNC الأشكال الرمزية، فهل هذا يساعد؟</p></li>
</ol>
<p>نعم ولكن جزئيًا. من خلال وجود شكل رمزي، لم تعد عملية تحسين التجميع تتطلب قيم أشكال ملموسة. وبعبارة أخرى، فإن نواة المولد أكثر عمومية من نوى الأشكال الثابتة لـ XLA.</p>
<p>وما هي المشكلة التي يساعد ذلك على حلها بالضبط؟</p>
<p>إنه يساعد في الحالات مثل #1 و #2.1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>الشكل [3، 5] -&gt; إضافة -&gt; عبر -&gt; ... -&gt; مضروب
الشكل [6، 2] -&gt; إضافة -&gt; عبر -&gt; ... -&gt; مضروب

# مع الشكل الرمزي
الشكل [x، y] -&gt; إضافة -&gt; عبر -&gt; ... -&gt; مضروب
</pre></div>
</div>
<p>مع الشكل الرمزي، لا يعيد نواة المولد التجميع كما تفعل XLA مع الأشكال الثابتة.</p>
<p>تحل XLA هذه المشكلة بطريقة أخرى، باستخدام التعبئة/التقسيم إلى دلو (لـ #1) والشكل الديناميكي المحدود (لـ #2.1).</p>
<p>طرح Brian Hirsh (&#64;bdhirsh) بعض الأسئلة الجيدة حقًا في التعليق، والانتقال من هنا إلى جعلها أكثر وضوحًا:</p>
<ol class="arabic simple">
<li><p>هل يستحق الأمر وضع TORCH_WARN في نوى XLA للمشغلين الذين ينتجون أشكال إخراج تعتمد على البيانات؟</p></li>
</ol>
<p>نعم، من المفيد أن يخبر المستخدمين “هاي، لن يعمل برنامجك بسرعة كبيرة”. ولكن بالنسبة لهذه المشغلين المعتمدين على البيانات، لا توجد إعادة كتابة سهلة لهم ما لم يغير المستخدمون المنطق في نموذجهم. (مثال آخر هو torch.unique())</p>
<ol class="arabic simple">
<li><p>كيف تؤثر المشغلين مثل nonzero على قدرتنا على إلغاء الظاهرية sizes()؟ إذا أردنا إلغاء الظاهرية sizes()، فسوف نحتاج إلى القدرة على حساب الأحجام بشكل متلهف لكل عملية - ألا يعني ذلك أننا مجبرون على تقييم الرسم البياني في كل مرة نصادف فيها عملية مثل nonzero؟ مقابل في الوقت الحالي، يبدو أننا لا نجبر التقييم فعليًا عندما يستدعي المستخدم nonzero()؟</p></li>
</ol>
<p>سؤال رائع! لذلك، في الشكل الحالي، فهو ليس حاصرا صعبًا نظرًا لأن size() على موترات XLA لا تحمل معلومات حجم الحقيقة. كما هو موضح في المثال، فإن مصدر الحقيقة يعيش في IRValue ويمكن استرجاعه بواسطة _get_xla_tensor_dimension_size فقط. لذا، إذا قررنا إلغاء الظاهرية size، فسيفرض ذلك هذا التباين.</p>
<p>كمتابعة، إذا كان لدينا size() لإعادة موتر بدلاً من القيم كما هو مذكور في الحلول البديلة المقترحة أعلاه. في هذه الحالة، لن تتمكن size() من إلغاء الظاهرية نظرًا لأنها تصبح مشغلًا (يأخذ موتر كإدخال وينتج موتر، ولديه عمليات تنفيذ مختلفة لواجهات خلفية مختلفة.)</p>
<ol class="arabic simple">
<li><p>إذا قمت، على سبيل المثال، باستدعاء <code class="docutils literal notranslate"><span class="pre">torch.add(input،</span> <span class="pre">1)</span></code> في حلقة، حيث يختلف الإدخال في الحجم من 1 إلى 1000، فعادة ما يتعين علينا تجميع 1000 رسم بياني مختلف - ولكن مع الأشكال الديناميكية، يبدو أن XLA ستتمكن داخليًا من إنشاء رسم بياني واحد حيث تقول “استخدم هذا الرسم البياني إذا كان حجم الإدخال &lt;=1000”. سؤالي هو: هل “الشكل الديناميكي” خاصية الرسم البياني فقط؟ أو من الرسم البياني والإدخال. بمعنى إذا كان رمزي هو <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">torch.add(input،</span> <span class="pre">1)؛</span> <span class="pre">x.sizes()</span></code> في حلقة، فهل لدى x شكل ديناميكي في هذه المرحلة، مما يعني أننا سنحتاج إلى تشغيل الرسم البياني للحصول على الأحجام؟ أو هل يمكننا جعله خاصية محسوبة بإهمال حتى في وجود رسوم بيانية ذات أشكال ديناميكية.</p></li>
</ol>
<p>نعم، في هذه الحالة، ستجمع 1000 رسم بياني مختلف. تعني الأشكال الديناميكية أن إدخالها يحتوي على بُعد ديناميكي. لذا، عند الاستعلام عن <code class="docutils literal notranslate"><span class="pre">x.sizes()</span></code> (حاليًا يجب استخدام get_dimention_size للحصول على الحجم الصحيح) فإنه سيؤدي إلى تشغيل <em>التنفيذ</em> (نظرًا لأن الحجم لم يتغير، فإنه لا يؤدي إلى إعادة التجميع). بدون السطر الذي يصل إلى الحجم، فلن يؤدي إلى أي إعادة تجميع/تنفيذ عندما يكون للإدخال بُعد ديناميكي.</p>
<ol class="arabic simple">
<li><p>هل سيكون البديل لجعل تدفق التحكم متاحًا في الرسم البياني هو مجرد التوصل إلى طريقة لضمان عدم احتواء رسوم XLA البيانية على تدفق التحكم؟ أي إذا كان لدينا نموذج به شرط واحد في المنتصف، فاجعل XLA ينتج 3 رسوم بيانية: 1 لكل شيء قبل الشرط، و1 لفرع if، و1 لفرع else. وهذا يعني أنك لا تحصل على الانفجار الأسي لرسوم بيانية جديدة لكل مجموعة من المسارات المتخذة، ولكن (أ) الرسوم البيانية أصغر وتوفر فرص تحسين أقل، و(ب) سيكون من الصعب جدًا جعل XLA يتعرف على المكان الذي يتم فيه اتخاذ مسار شرطي.</p></li>
</ol>
<p>نقطة عظيمة! لذلك، إذا تمكنا من تقسيمها إلى رسوم بيانية أصغر، فمن الممكن القيام بذلك. ولكن في الممارسة العملية، هذا النمط مزعج:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">some</span> <span class="n">computation</span><span class="o">&gt;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span>
<span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span><span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
<p>لاحظ أنك ستقيم x باستخدام رسم بياني فرعي عند الوصول إلى تدفق التحكم، ولكن قد يكون هناك متغير سابق مدرج في حساب الفرع أيضًا (مثل “y” هو عق</p>
</div>


             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright .

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">1. من مجموعة البيانات المدخلة</a></li>
<li><a class="reference internal" href="#id2">2. من إخراج المشغل</a></li>
<li><a class="reference internal" href="#id3">3. من تدفق التحكم</a></li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
         <script src="../_static/jquery.js"></script>
         <script src="../_static/underscore.js"></script>
         <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
         <script src="../_static/doctools.js"></script>
         <script src="../_static/sphinx_highlight.js"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title">Stay up to date</li>
            <li><a href="https://www.facebook.com/pytorch" target="_blank">Facebook</a></li>
            <li><a href="https://twitter.com/pytorch" target="_blank">Twitter</a></li>
            <li><a href="https://www.youtube.com/pytorch" target="_blank">YouTube</a></li>
            <li><a href="https://www.linkedin.com/company/pytorch" target="_blank">LinkedIn</a></li>
          </ul>  
          </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title">PyTorch Podcasts</li>
            <li><a href="https://open.spotify.com/show/6UzHKeiy368jKfQMKKvJY5" target="_blank">Spotify</a></li>
            <li><a href="https://podcasts.apple.com/us/podcast/pytorch-developer-podcast/id1566080008" target="_blank">Apple</a></li>
            <li><a href="https://www.google.com/podcasts?feed=aHR0cHM6Ly9mZWVkcy5zaW1wbGVjYXN0LmNvbS9PQjVGa0lsOA%3D%3D" target="_blank">Google</a></li>
            <li><a href="https://music.amazon.com/podcasts/7a4e6f0e-26c2-49e9-a478-41bd244197d0/PyTorch-Developer-Podcast?" target="_blank">Amazon</a></li>
          </ul>
         </div>
        </div>
        
        <div class="privacy-policy">
          <ul>
            <li class="privacy-policy-links"><a href="https://www.linuxfoundation.org/terms/" target="_blank">Terms</a></li>
            <li class="privacy-policy-links">|</li>
            <li class="privacy-policy-links"><a href="https://www.linuxfoundation.org/privacy-policy/" target="_blank">Privacy</a></li>
          </ul>
        </div>
        <div class="copyright">
        <p>© Copyright The Linux Foundation. The PyTorch Foundation is a project of The Linux Foundation.
          For web site terms of use, trademark policy and other policies applicable to The PyTorch Foundation please see
          <a href="https://www.linuxfoundation.org/policies/">www.linuxfoundation.org/policies/</a>. The PyTorch Foundation supports the PyTorch open source
          project, which has been established as PyTorch Project a Series of LF Projects, LLC. For policies applicable to the PyTorch Project a Series of LF Projects, LLC,
          please see <a href="https://www.lfprojects.org/policies/">www.lfprojects.org/policies/</a>.</p>
      </div>
     </div>

  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
           <li class="resources-mobile-menu-title">
             <a>Learn</a>
           </li>
           <ul class="resources-mobile-menu-items">
             <li>
               <a href="https://pytorch.org/get-started">Get Started</a>
             </li>
             <li>
               <a href="https://pytorch.org/tutorials">Tutorials</a>
             </li>
             <li>
               <a href="https://pytorch.org/tutorials/beginner/basics/intro.html">Learn the Basics</a>
             </li>
             <li>
               <a href="https://pytorch.org/tutorials/recipes/recipes_index.html">PyTorch Recipes</a>
             </li>
             <li>
               <a href="https://pytorch.org/tutorials/beginner/introyt.html">Introduction to PyTorch - YouTube Series</a>
             </li>
           </ul>
           <li class="resources-mobile-menu-title">
             <a>Ecosystem</a>
           </li>
           <ul class="resources-mobile-menu-items">
             <li>
               <a href="https://pytorch.org/ecosystem">Tools</a>
             </li>
             <li>
               <a href="https://pytorch.org/#community-module">Community</a>
             </li>
             <li>
               <a href="https://discuss.pytorch.org/">Forums</a>
             </li>
             <li>
               <a href="https://pytorch.org/resources">Developer Resources</a>
             </li>
             <li>
               <a href="https://pytorch.org/ecosystem/contributor-awards-2023">Contributor Awards - 2023</a>
             </li>
           </ul>

           <li class="resources-mobile-menu-title">
             <a>Edge</a>
           </li>

           <ul class="resources-mobile-menu-items">
             <li>
               <a href="https://pytorch.org/edge">About PyTorch Edge</a>
             </li>
             
             <li>
               <a href="https://pytorch.org/executorch-overview">ExecuTorch</a>
             </li>
           </ul>

           <li class="resources-mobile-menu-title">
             <a>Docs</a>
           </li>

           <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
            </li>

            <li>
              <a href="https://pytorch.org/pytorch-domains">PyTorch Domains</a>
            </li>
          </ul>

          <li class="resources-mobile-menu-title">
            <a>Blog & News</a>
          </li>
            
           <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/blog/">PyTorch Blog</a>
            </li>
            <li>
              <a href="https://pytorch.org/community-blog">Community Blog</a>
            </li>

            <li>
              <a href="https://pytorch.org/videos">Videos</a>
            </li>

            <li>
              <a href="https://pytorch.org/community-stories">Community Stories</a>
            </li>
            <li>
              <a href="https://pytorch.org/events">Events</a>
            </li>
          </ul>
          
          <li class="resources-mobile-menu-title">
            <a>About</a>
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/foundation">PyTorch Foundation</a>
            </li>
            <li>
              <a href="https://pytorch.org/governing-board">Governing Board</a>
            </li>
          </ul>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>